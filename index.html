<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Supervisión de rutinas operacionales</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <style>
        .nav-pills>a.active {
            background-color: #4CAF50 !important;
            color: #ffffff !important;
        }
        .nav-pills>a:hover {
            color: #4CAF50;
        }
        .nav-link-color {
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="container my-4">
        <div class="row">
            <div class="col-2">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <a class="nav-link active" id="main-tab" data-toggle="pill" href="#admin" role="tab" aria-controls="admin" aria-selected="true">Informe de rutinas</a>
                    <a class="nav-link" id="areas-tab" data-toggle="pill" href="#areas" role="tab" aria-controls="areas" aria-selected="false">Areas</a>
                    <a class="nav-link" id="help-tab" data-toggle="pill" href="#adminTrab" role="tab" aria-controls="adminTrab" aria-selected="false">Administrar trabajadores</a>
                    <a class="nav-link" id="modificar-tab" data-toggle="pill" href="#modRutinas" role="tab" aria-controls="modRutinas" aria-selected="false">Modificar rutinas</a>
                    <a class="nav-link" id="newRutina-tab" data-toggle="pill" href="#newRutina" role="tab" aria-controls="newRutina" aria-selected="false">Añadir rutina</a>
                    <a class="nav-link" id="estadisticas-tab" data-toggle="pill" href="#estadisticas" role="tab" aria-controls="estadisticas" aria-selected="false">Estadisticas</a>
                    <a class="nav-link" id="user-tab" data-toggle="pill" href="#user" role="tab" aria-controls="user" aria-selected="false">Formulario</a>
                    <a class="nav-link" id="cuentas-tab" data-toggle="pill" href="#adminCuentas" role="tab" aria-controls="adminCuentas" aria-selected="false">Administrar cuentas</a>
                    <a class="nav-link" id="login-tab" data-toggle="pill" href="#login" role="tab" aria-controls="login" aria-selected="false">Iniciar sesión</a>
                </div>
            </div>
            <div class="col-10">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="admin" role="tabpanel" aria-labelledby="admin-tab"></div>
                    <div class="tab-pane fade" id="adminTrab" role="tabpanel" aria-labelledby="adminTrab-tab"></div>
                    <div class="tab-pane fade" id="areas" role="tabpanel" aria-labelledby="areas-tab"></div>
                    <div class="tab-pane fade" id="modRutinas" role="tabpanel" aria-labelledby="modRutinas-tab"></div>
                    <div class="tab-pane fade" id="estadisticas" role="tabpanel" aria-labelledby="estadisticas-tab"></div>
                    <div class="tab-pane fade" id="user" role="tabpanel" aria-labelledby="user-tab"></div>
                    <div class="tab-pane fade" id="login" role="tabpanel" aria-labelledby="login-tab"></div>
                    <div class="tab-pane fade" id="newRutina" role="tabpanel" aria-labelledby="newRutina-tab"></div>
                    <div class="tab-pane fade" id="adminCuentas" role="tabpanel" aria-labelledby="adminCuentas-tab"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts al final para mejorar el rendimiento -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="./renderer.js"></script>

    <script>
    //SCRIPT CARGAR ELEMENTOS SIDEBAR
    window.addEventListener('load', (event) => {
        const pages = [
            'areas.html',
            'admin.html',
            'adminCuentas.html',
            'adminTrab.html',
            'estadisticas.html',
            'login.html',
            'modRutinas.html',
            'newRutina.html',
            'user.html',
        ];

        const loadPage = async (page) => {
            try {
                const response = await fetch(`pages/${page}`);
                const html = await response.text();
                const div = document.createElement('div');
                div.innerHTML = html;
                const template = div.querySelector('template');
                const clone = document.importNode(template.content, true);
                const targetTab = document.getElementById(page.replace('.html',''));
                if (targetTab) {
                    targetTab.appendChild(clone);
                    console.log(`Página ${page} cargada correctamente.`);
                } else {
                    console.error(`Error: Contenedor para ${page} no encontrado.`);
                }
                const script = div.querySelector('script');
                if (script) {
                    const scriptElement = document.createElement('script');
                    scriptElement.innerHTML = script.innerHTML;
                    targetTab.body.appendChild(scriptElement);
                    console.log(`Script de ${page} cargado correctamente.`);
                }
            } catch (error) {
                console.error(`Error al cargar la página ${page}: ${error}`);
            }
        };
        pages.forEach((page) => {
            console.log(`Cargando página: ${page}`);
            loadPage(page);
            });
        });

        //SCIPTS INFORME RUTINAS
        function filtrarTabla() {
        var input = document.getElementById('search').value.toLowerCase();
        var filter = document.getElementById('filter').value.toLowerCase();
        var rows = document.querySelectorAll('tbody tr');
    
        rows.forEach(function(row) {
            var cells = row.getElementsByTagName('td');
            var matchSearch = Array.from(cells).some(cell => cell.textContent.toLowerCase().includes(input));
            var matchFilter = filter === 'todos' || cells[1].textContent.toLowerCase().includes(filter);
    
            if (matchSearch && matchFilter) {
            row.style.display = '';
            } else {
            row.style.display = 'none';
            }
        });
    }
        //SCRIPTS ADMIN CUENTAS
        function eliminarUsuario(nombreUsuario) {
            var confirmarEliminar = confirm(`¿Estás seguro de que deseas eliminar a ${nombreUsuario}?`);
            if (confirmarEliminar) {
                // Lógica para eliminar el usuario
                console.log(`Usuario ${nombreUsuario} eliminado.`);
            }
        }

        function crearNuevoUsuario() {
            // Lógica para crear un nuevo usuario
            console.log("Crear nuevo usuario");
        }
        // SCRIPTS PARA AREAS
        function confirmEdit() {
              var confirmEdit = confirm('¿Estás seguro de que deseas editar esta área?');
              if (confirmEdit) {
                editOption();
              }
            }
            function confirmAdd() {
              var confirmAdd = confirm('¿Estás seguro de que deseas agregar esta área?');
              if (confirmAdd) {
                addOption();
              }
            }
            function confirmDelete() {
              var confirmDelete = confirm('¿Estás seguro de que deseas eliminar este área?');
              if (confirmDelete) {
                deleteOption();
              }
            }
            function editOption() {
              var selectElement = document.getElementById('options');
              var newValue = document.getElementById('newValue').value;
              if (!newValue) {
                alert('Por favor, ingresa un valor.');
                return;
              }
              var selectedIndex = selectElement.selectedIndex;
              if (selectedIndex !== -1) {
                selectElement.options[selectedIndex].text = newValue;
                selectElement.options[selectedIndex].value = newValue;
                alert('Área editada con éxito.');
              } else {
                alert('Por favor, selecciona un área.');
              }
              clearForm();
            }
            function addOption() {
              var selectElement = document.getElementById('options');
              var newValue = document.getElementById('newValue').value;
              if (!newValue) {
                alert('Por favor, ingresa un valor.');
                return;
              }
              var option = document.createElement('option');
              option.text = newValue;
              option.value = newValue;
              selectElement.add(option);
              alert('Área agregada con éxito.');
              clearForm();
            }
            function deleteOption() {
              var selectElement = document.getElementById('options');
              var selectedIndex = selectElement.selectedIndex;
              if (selectedIndex !== -1) {
                selectElement.remove(selectedIndex);
                alert('Área eliminada con éxito.');
              } else {
                alert('Por favor, selecciona un área.');
              }
              clearForm();
            }     
            function clearForm() {
              document.getElementById('newValue').value = '';
            }
            //SCRIPTS RUTINAS POR AREA
              function cargarRutinas() {
                var selectedArea = document.getElementById('areas').value;
                var rutinas = rutinasPorArea[selectedArea] || [];
          
                var tablaRutinas = document.getElementById('tablaRutinas');
                var tbody = tablaRutinas.getElementsByTagName('tbody')[0];
                
                // Limpiamos el contenido anterior de la tabla
                tbody.innerHTML = '';
          
                // Llenamos la tabla con las rutinas
                rutinas.forEach(function(rutina) {
                  var row = tbody.insertRow();
                  row.insertCell(0).innerText = rutina.id;
                  row.insertCell(1).innerText = rutina.rutina;
                  row.insertCell(2).innerText = rutina.dia;
                  row.insertCell(3).innerText = rutina.turno;
          
                  // botones
                  var cellAcciones = row.insertCell(4);
                  var btnEditar = document.createElement('button');
                  btnEditar.innerText = 'Editar';
                  btnEditar.onclick = function() { editarRutina(rutina.id); };
                  cellAcciones.appendChild(btnEditar);
          
                  var btnBorrar = document.createElement('button');
                  btnBorrar.innerText = 'Borrar';
                  btnBorrar.onclick = function() { borrarRutina(rutina.id); };
                  cellAcciones.appendChild(btnBorrar);
                });
              }
          
              function editarRutina(id) {
                // editar rutina
                alert('Editar rutina con ID: ' + id);
              }
          
              function borrarRutina(id) {
                // borrar rutina
                alert('Borrar rutina con ID: ' + id);
              }
              //SCRIPTS ADMIN TRABAJADORES
              function openForm() {
              document.getElementById('addWorkerForm').style.display = 'block';
            }
        
            function closeForm() {
              document.getElementById('addWorkerForm').style.display = 'none';
            }
            function updateWorker() {
              var workerName = document.getElementById('workerName').value;
              var workerArea = document.getElementById('workerArea').value;
              var workerRole = document.getElementById('workerRole').value;
        
              // Puedes realizar acciones de actualización, por ejemplo, enviar datos al servidor
              alert(`Actualizando trabajador: ${workerName}, Área: ${workerArea}, Rol: ${workerRole}`);
            }
        
            function deleteWorker() {
              var workerName = document.getElementById('workerName').value;
        
              // Puedes realizar acciones de eliminación, por ejemplo, enviar datos al servidor
              alert(`Eliminando trabajador: ${workerName}`);
            }
        
            // Event listener para actualizar las áreas y roles cuando se selecciona un trabajador
            document.getElementById('workerName').addEventListener('change', function() {
              var selectedWorker = this.value;
        
              // Simula obtener información del trabajador desde una fuente de datos (puedes reemplazarlo con datos reales)
              var workerDetails = getWorkerDetails(selectedWorker);
        
              // Actualiza los campos de área y rol con la información obtenida
              document.getElementById('workerArea').value = workerDetails.area;
              document.getElementById('workerRole').value = workerDetails.role;
            });
        
            // Simula obtener información del trabajador desde una fuente de datos (puedes reemplazarlo con datos reales)
            function getWorkerDetails(workerName) {
              // Este es solo un ejemplo. Deberías obtener los detalles del trabajador desde tu fuente de datos (base de datos, API, etc.)
              var workerDetails = {
                'Dario Aguilar': { area: 'Turbogeneradores', role: 'Operador Turbogeneradores' },
                'Gustavo González': { area: 'Área 2', role: 'Operador terreno Multipropósito' }
                // Agrega más detalles según sea necesario
              };
              return workerDetails[workerName] || { area: '', role: '' };
            }
            //SCRIPTS ESTADISTICAS
            function generateStats() {
            var selectedArea = document.getElementById('area').value;
            // Aquí deberías realizar lógica para obtener datos estadísticos basados en el área seleccionada
            var statsData = getStatsData(selectedArea);
            // Llama a la función para crear/graficar el gráfico
            renderChart(statsData);
          }
          function getStatsData(area) {
            // Simula obtener datos estadísticos desde una fuente de datos (reemplaza con datos reales)
            var statsData = {
              labels: ['Categoría 1', 'Categoría 2', 'Categoría 3', 'Categoría 4', 'Categoría 5'],
              datasets: [
                {
                  label: 'Datos de Estadísticas',
                  data: [20, 35, 25, 15, 30], // Aquí deberías tener los datos reales basados en el área
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }
              ]
            };
            return statsData;
          }
          function renderChart(statsData) {
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, { // problema con Chart.js
              type: 'bar', // Puedes cambiar el tipo de gráfico según tus necesidades
              data: statsData,
              options: {
                responsive: true,
                scales: {
                  x: {
                    beginAtZero: true
                  },
                  y: {
                    beginAtZero: true
                  }
                }
              }
            });
          }  
        function marcarTodosLosDias() {
        const checkboxDiario = document.getElementById('diario');
        const checkboxesDias = document.getElementsByName('dias');
        if (checkboxDiario.checked) {
            checkboxesDias.forEach(checkbox => {
            checkbox.checked = true;
            });
        } else {
            checkboxesDias.forEach(checkbox => {
            checkbox.checked = false;
            });
        }
        }
    </script>
</body>
</html>